{% extends 'core/base.html'%}
{%block contenido%}
{% load static %}


   
      <div class="container col-sm-12 col-md-8 col-lg-8">
        <div id="carouselExampleDark" class="carousel carousel-dark slide">
<style>
    .small-carousel-image {
        max-width: 100%;
        height: auto;
    }

    .carousel-caption {
        background-color: white;
        padding: 10px;
        border-radius: 10px;
    }
</style>

          

          
        <!-- Indicadores -->
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="0" class="active"
                aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="1"
                aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="2"
                aria-label="Slide 3"></button>
        </div>

        <!-- Imágenes -->
        <div class="carousel-inner">
            <div class="carousel-item active" data-bs-interval="10">
                <img src="{% static '/img/Ferremax.webp' %}"
                    class="d-block w-100 object-fit-contain small-carousel-image" alt="...">
                <div class="carousel-caption d-none d-md-block">
                    <h5>En Ferremax podrás encontrar la mejor atención</h5>
                    <p>Una amplia variedad de productos de ferretería y construcción de marcas como Bosch y Makita.
                        Nuestro equipo te asesorará en la elección de herramientas y materiales. Además, ahora puedes
                        comprar en línea con opciones de retiro en tienda o entrega a domicilio, y múltiples métodos de
                        pago.</p>
                </div>
            </div>
            <div class="carousel-item" data-bs-interval="1000">
                <img src="{% static '/img/Ferremax1.webp' %}"
                    class="d-block w-100 object-fit-contain small-carousel-image" alt="...">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Nos preocupamos por ti</h5>
                    <p>Ofreciendo un servicio personalizado y asegurando que encuentres todo lo que necesitas para tus
                        proyectos. Con nuestra plataforma en línea, facilitamos tus compras con entregas rápidas y
                        seguras, y siempre estamos disponibles para resolver tus dudas y brindarte el mejor soporte.</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="{% static '/img/Ferremax2.jpg' %}"
                    class="d-block w-100 object-fit-contain small-carousel-image" alt="...">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Podrás encontrar todo tipo de productos</h5>
                    <p>Desde herramientas manuales y eléctricas hasta materiales de construcción y artículos de
                        seguridad. Nuestra amplia gama garantiza que siempre tengas acceso a lo que necesitas, ya sea
                        para proyectos grandes o pequeños.</p>
                </div>
            </div>
        </div>

        <!-- Controles de navegación -->
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
          </button>
          
        </div>
      </div>
        </button>

    </div>
</div>
<br>
<style>
    .precio-original {
        text-decoration: line-through;
        color: red;
    }
    .producto-separador {
        border-top: 1px solid #ddd;
        margin: 20px 0;
    }
</style>



<!--Inicio ofertas-->

<div class="container">
    <h2>Productos con Descuento</h2>
    <div id="productos-container" class="row"></div><br>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const productosContainer = document.getElementById('productos-container');

        const cargarProductos = () => {
            // Realizar la solicitud AJAX para obtener los productos
            fetch('http://127.0.0.1:5000/api/products')
                .then(response => response.json())
                .then(data => {
                    // Filtrar productos de la marca Makita
                    const filteredProducts = data.filter(producto => producto.Marca.trim().toLowerCase() === 'makita').slice(0, 4); // Tomar solo los primeros 4 productos

                    // Limpiar el contenedor de productos antes de agregar nuevos
                    productosContainer.innerHTML = '';

                    // Mostrar productos
                    filteredProducts.forEach(producto => {
                        const productoDiv = document.createElement('div');
                        productoDiv.classList.add('col-md-3', 'mb-4');

                        // Aplicar el descuento del 15% al precio
                        const precioOriginal = producto.Precio;
                        const precioConDescuento = precioOriginal * 0.85;
                        const precioOriginalChileno = precioOriginal.toLocaleString('es-CL', { style: 'currency', currency: 'CLP' });
                        const precioConDescuentoChileno = precioConDescuento.toLocaleString('es-CL', { style: 'currency', currency: 'CLP' });

                        productoDiv.innerHTML = `<br>
                            <div class="card">
                                <img src="${producto.Imagen}" class="card-img-top" alt="${producto.Nombre}">
                                <div class="card-body">
                                    <h5 class="card-title">${producto.Nombre}</h5>
                                    <p class="card-text"><strong>Código del producto:</strong> ${producto['Código del producto']}</p>
                                    <p class="card-text"><strong>Categoría:</strong> ${producto.Categoria}</p>
                                    <p class="card-text"><strong>Marca:</strong> ${producto.Marca}</p>
                                    <p class="card-text precio-original"><strong>Precio Original:</strong> ${precioOriginalChileno}</p>
                                    <p class="card-text"><strong>Precio con Descuento:</strong> ${precioConDescuentoChileno} (15% OFF)</p>
                                    <a href="#" class="btn btn-success stretched-link" data-id="${producto.id}">Agregar al carrito</a>
                                </div>
                            </div>
                        `;

                        productosContainer.appendChild(productoDiv);
                    });
                    console.log("Productos ofertas:", filteredProducts);
                })
                .catch(error => {
                    console.error('Error al cargar los productos:', error);
                });
        };

        // Cargar productos al cargar la página
        cargarProductos();
    });
</script>
<!--Inicio novedades-->

<div class="container">
    <h1 class="my-4">Novedades de Productos</h1>
    <div id="productos-Container2" class="row"></div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const productosContainer2 = document.getElementById('productos-Container2');

        const cargarNovedades = () => {
            // Realizar la solicitud AJAX para obtener los productos
            fetch('http://127.0.0.1:5000/api/products')
                .then(response => response.json())
                .then(data => {
                    // Ordenar los productos por fecha de manera descendente
                    const filteredProducts = data
                        .sort((b, a) => new Date(b.Fecha) - new Date(a.Fecha))
                        .slice(0, 4); // Tomar solo los primeros 10 productos más recientes

                    // Limpiar el contenedor de productos antes de agregar nuevos
                    productosContainer2.innerHTML = '';

                    // Mostrar productos
                    filteredProducts.forEach(producto => {
                        const productoDiv = document.createElement('div');
                        productoDiv.classList.add('col-md-3', 'mb-4');

                        const precioOriginal = producto.Precio;
                        const precioOriginalChileno = precioOriginal.toLocaleString('es-CL', { style: 'currency', currency: 'CLP' });

                        productoDiv.innerHTML = `
                            <div class="card">
                                <img src="${producto.Imagen}" class="card-img-top" alt="${producto.Nombre}">
                                <div class="card-body">
                                    <h5 class="card-title">${producto.Nombre}</h5>
                                    <p class="card-text"><strong>Código del producto:</strong> ${producto['Código del producto']}</p>
                                    <p class="card-text"><strong>Categoría:</strong> ${producto.Categoria}</p>
                                    <p class="card-text"><strong>Marca:</strong> ${producto.Marca}</p>
                                    <p class="card-text precio-originalN"><strong>Precio:</strong> ${precioOriginalChileno}</p>
                                    <a href="#" class="btn btn-success stretched-link" data-id="${producto.id}">Agregar al carrito</a>
                                </div>
                            </div>
                        `;

                        productosContainer2.appendChild(productoDiv);
                    });
                    console.log("Productos novedades:", filteredProducts);
                })
                .catch(error => {
                    console.error('Error al cargar los productos:', error);
                });
        };

        // Cargar novedades al cargar la página
        cargarNovedades();
    });
</script>





      <br><br><br>
      
      <section class="conteiner-fluid ps-0 pe-0 bg-warning">
        <div class="row pt-2 m-0 text-center">
          <div class="col-md-4 mt-2 mb-3">
            <img src="{% static 'img/carrito.png'%}" alt="" style="max-width: 75px;">
            <a class="text-decoration-none text-black">Despachos</a>
            <p>24 a 48 hrs</p>
          </div>
          <div class="col-md-4 mt-2 mb-3">
            <img src="{% static 'img/tienda.png'%}" alt="" style="max-width: 75px;">
            <a class="text-decoration-none text-black">Retiros en tienda</a>
            <p>09:00 a 17:30 hrs</p>
          </div>
          <div class="col-md-4 mt-2 mb-3">
            <img src="{% static 'img/people.png'%}" alt="" style="max-width: 75px;">
            <a class="text-decoration-none text-black">Opiniones</a>
            <p>Feed</p>
          </div>
        </div>






{% endblock %}
